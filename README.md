## Kubernetes KMS Plugin

### Introduction

This project is an extension of the Kubernetes KMSv2 feature, which aims to enable encryption-at-rest using a KMS plugin. The main motivation is to integrate a physical random generator into the on-premise server create a HSM-like system for more secure encryption.

In my design, the KMS plugin will communicate with an on-premise server via REST APIs. The key encryption keys (KEKs) are generated by running a script on the on-premise server, and then saved in the on-premise server. Only the ciphertext/ plaintext is returned to the plugin via REST APIs.

Code for the on-premise-server can be found at https://github.com/kaijun123/kms-on-premise-server. The on-premise-server must be running before running the plugin.

### Explanation of KMS v2beta1
- Refer to [KMS.md](pkg/scripts/KMS.md) for a full explanation
<p align="center">
    <img src="images/Decrypt-Request.png">
    <img src="images/Encrypt-Request.png">
    <img src="images/Status-Request.png">
    <img src="images/Generate-DEK.png">
</p>

### Environment
- M1 Mac (arm64)
- Docker Desktop 4.9.0 
- Kubernetes v1.27

### Directory
- ```pkg/scripts```: 
  - Contains yaml files for configuration and 2 shell scripts to simplify the configuration process. 
  - The scripts will be run in the control-panel shell, after the directory is mounted
- ```pkg/plugins/plugin.go```: Entrance of the repo